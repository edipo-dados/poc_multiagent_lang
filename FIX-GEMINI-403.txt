â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
âŒ ERRO 403 FORBIDDEN - GEMINI API KEY INVÃLIDA
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ERRO: 403 Client Error: Forbidden

CAUSA: A API key do Gemini estÃ¡ invÃ¡lida, expirou ou nÃ£o tem permissÃµes.

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ”‘ SOLUÃ‡ÃƒO: GERAR NOVA API KEY DO GEMINI
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. Acesse: https://aistudio.google.com/app/apikey

2. FaÃ§a login com sua conta Google

3. Clique em "Create API Key" ou "Get API Key"

4. Copie a nova API key gerada

5. Atualize o .env no servidor:

   nano .env

   # Substitua a linha:
   GEMINI_API_KEY=AIzaSyBVk3MFe3zRRGVMaEslphM3Vd85oS5Rz44

   # Por:
   GEMINI_API_KEY=SUA_NOVA_API_KEY_AQUI

   # Salvar: Ctrl+O, Enter, Ctrl+X

6. Reiniciar backend:

   docker compose restart backend

7. Testar novamente:

   curl -X POST http://localhost:8000/analyze \
     -H 'Content-Type: application/json' \
     -d '{"regulatory_text":"RESOLUÃ‡ÃƒO BCB NÂº 789/2024","repo_path":"/app/fake_pix_repo"}'

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ” VERIFICAR API KEY ATUAL
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Testar API key diretamente
curl "https://generativelanguage.googleapis.com/v1beta/models?key=AIzaSyBVk3MFe3zRRGVMaEslphM3Vd85oS5Rz44"

# Se retornar 403:
# âŒ API key invÃ¡lida ou sem permissÃµes

# Se retornar lista de modelos:
# âœ… API key vÃ¡lida

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
âš ï¸  POSSÃVEIS CAUSAS DO ERRO 403
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. API key expirou
2. API key foi revogada
3. API key nÃ£o tem permissÃ£o para Gemini API
4. Projeto Google Cloud nÃ£o tem Gemini API habilitada
5. Cota excedida (improvÃ¡vel para nova key)
6. RestriÃ§Ãµes de IP/domÃ­nio na API key

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ”§ ALTERNATIVA: USAR OPENAI (SE TIVER CRÃ‰DITOS)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Se nÃ£o conseguir resolver o Gemini, pode usar OpenAI:

# 1. Editar .env
nano .env

# 2. Mudar para:
LLM_TYPE=openai
OPENAI_API_KEY=sua_openai_key_aqui
OPENAI_MODEL=gpt-3.5-turbo

# 3. Reiniciar
docker compose restart backend

# 4. Testar
curl -X POST http://localhost:8000/analyze \
  -H 'Content-Type: application/json' \
  -d '{"regulatory_text":"RESOLUÃ‡ÃƒO BCB NÂº 789/2024","repo_path":"/app/fake_pix_repo"}'

NOTA: OpenAI tem rate limits no free tier (3 RPM)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ†“ ALTERNATIVA: USAR MODELO OLLAMA MENOR
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Se nÃ£o tiver API keys vÃ¡lidas, use modelo local menor:

# 1. Editar .env
nano .env

# 2. Mudar para:
LLM_TYPE=ollama
OLLAMA_BASE_URL=http://ollama:11434
OLLAMA_MODEL=llama3.2:1b

# 3. Subir Ollama
docker compose up -d ollama

# 4. Aguardar e baixar modelo pequeno (~1.3GB)
sleep 30
docker compose exec ollama ollama pull llama3.2:1b

# 5. Reiniciar backend
docker compose restart backend

# 6. Testar
curl -X POST http://localhost:8000/analyze \
  -H 'Content-Type: application/json' \
  -d '{"regulatory_text":"RESOLUÃ‡ÃƒO BCB NÂº 789/2024","repo_path":"/app/fake_pix_repo"}'

NOTA: llama3.2:1b usa apenas 1.3GB RAM (cabe na instÃ¢ncia)
Mas Ã© mais lento (~20-40s) e qualidade inferior

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“Š COMPARAÃ‡ÃƒO DE OPÃ‡Ã•ES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

GEMINI (com API key vÃ¡lida):
  âœ… Mais rÃ¡pido (2-5s)
  âœ… Melhor qualidade
  âœ… GrÃ¡tis com limites generosos
  âŒ Precisa API key vÃ¡lida

OPENAI:
  âœ… RÃ¡pido (3-8s)
  âœ… Boa qualidade
  âŒ Rate limits no free tier (3 RPM)
  âŒ Precisa API key vÃ¡lida

OLLAMA llama3.2:1b:
  âœ… Funciona offline
  âœ… Cabe na RAM (1.3GB)
  âœ… Sem API keys
  âŒ Mais lento (20-40s)
  âŒ Qualidade inferior

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ’¡ RECOMENDAÃ‡ÃƒO
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. PRIMEIRO: Tente gerar nova API key do Gemini
   https://aistudio.google.com/app/apikey

2. SE NÃƒO FUNCIONAR: Use llama3.2:1b (modelo local pequeno)
   Pelo menos funciona sem depender de APIs externas

3. ÃšLTIMA OPÃ‡ÃƒO: OpenAI (se tiver crÃ©ditos)
   Mas tem rate limits no free tier
