â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ” TESTAR API KEY DO GEMINI DIRETAMENTE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Vamos testar a API key diretamente para ver o erro exato:

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“‹ TESTE 1: LISTAR MODELOS DISPONÃVEIS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

curl "https://generativelanguage.googleapis.com/v1beta/models?key=AIzaSyBVk3MFe3zRRGVMaEslphM3Vd85oS5Rz44"

# Se funcionar: âœ… API key vÃ¡lida
# Se der 403: âŒ Problema com a API key ou permissÃµes

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“‹ TESTE 2: GERAR CONTEÃšDO COM GEMINI-2.0-FLASH
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

curl "https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=AIzaSyBVk3MFe3zRRGVMaEslphM3Vd85oS5Rz44" \
  -H 'Content-Type: application/json' \
  -d '{"contents":[{"parts":[{"text":"Hello"}]}]}'

# Se funcionar: âœ… Modelo e API key OK
# Se der 403: âŒ Problema com permissÃµes ou modelo
# Se der 404: âŒ Modelo nÃ£o existe ou nome errado

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“‹ TESTE 3: TESTAR COM GEMINI-1.5-FLASH (MAIS ESTÃVEL)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

curl "https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=AIzaSyBVk3MFe3zRRGVMaEslphM3Vd85oS5Rz44" \
  -H 'Content-Type: application/json' \
  -d '{"contents":[{"parts":[{"text":"Hello"}]}]}'

# Se funcionar: âœ… Use gemini-1.5-flash em vez de 2.0

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ”§ POSSÃVEIS CAUSAS DO ERRO 403
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. API key tem restriÃ§Ãµes de IP/domÃ­nio
   SoluÃ§Ã£o: Remover restriÃ§Ãµes em https://aistudio.google.com/app/apikey

2. Gemini API nÃ£o estÃ¡ habilitada no projeto
   SoluÃ§Ã£o: Habilitar em https://console.cloud.google.com/apis/library/generativelanguage.googleapis.com

3. Modelo gemini-2.0-flash nÃ£o disponÃ­vel para sua conta
   SoluÃ§Ã£o: Usar gemini-1.5-flash ou gemini-1.5-pro

4. Cota excedida (improvÃ¡vel)
   SoluÃ§Ã£o: Verificar em https://console.cloud.google.com/apis/api/generativelanguage.googleapis.com/quotas

5. RegiÃ£o bloqueada
   SoluÃ§Ã£o: Verificar se Gemini estÃ¡ disponÃ­vel na sua regiÃ£o

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
âœ… SOLUÃ‡ÃƒO RÃPIDA: USAR GEMINI-1.5-FLASH
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Se gemini-2.0-flash der 403, use gemini-1.5-flash:

# 1. Editar .env
nano .env

# 2. Mudar de:
GEMINI_MODEL=gemini-2.0-flash

# Para:
GEMINI_MODEL=gemini-1.5-flash

# 3. Salvar: Ctrl+O, Enter, Ctrl+X

# 4. Reiniciar backend
docker compose restart backend

# 5. Testar
curl -X POST http://localhost:8000/analyze \
  -H 'Content-Type: application/json' \
  -d '{"regulatory_text":"RESOLUÃ‡ÃƒO BCB NÂº 789/2024","repo_path":"/app/fake_pix_repo"}'

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ” VERIFICAR RESTRIÃ‡Ã•ES DA API KEY
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. Acesse: https://aistudio.google.com/app/apikey

2. Clique na sua API key

3. Verifique:
   - Application restrictions: Deve estar "None" ou permitir seu IP
   - API restrictions: Deve incluir "Generative Language API"

4. Se tiver restriÃ§Ãµes, remova ou ajuste

5. Teste novamente

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“Š MODELOS GEMINI DISPONÃVEIS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

gemini-1.5-flash:
  âœ… Mais estÃ¡vel
  âœ… Amplamente disponÃ­vel
  âœ… RÃ¡pido
  âš ï¸  VersÃ£o anterior

gemini-2.0-flash:
  âœ… Mais recente
  âœ… Melhor qualidade
  âš ï¸  Pode nÃ£o estar disponÃ­vel para todas as contas
  âš ï¸  Pode ter restriÃ§Ãµes regionais

gemini-1.5-pro:
  âœ… Melhor qualidade
  âœ… Amplamente disponÃ­vel
  âš ï¸  Mais lento
  âš ï¸  Limites de rate mais baixos

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ’¡ RECOMENDAÃ‡ÃƒO
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. Execute TESTE 1 para verificar se API key funciona
2. Execute TESTE 2 para verificar gemini-2.0-flash
3. Se TESTE 2 der 403, execute TESTE 3 (gemini-1.5-flash)
4. Use o modelo que funcionar

Se nenhum funcionar:
  - Verifique restriÃ§Ãµes da API key
  - Ou use llama3.2:1b local (1.3GB RAM)
