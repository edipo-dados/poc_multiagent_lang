โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
๐งน LIMPAR TUDO E MIGRAR PARA GEMINI - EXECUTAR AGORA
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

โ SCRIPT CRIADO: cleanup-and-switch-gemini.sh

Este script faz TUDO automaticamente:
  1. Para containers
  2. Remove Ollama (host + Docker volume)
  3. Limpa Docker (imagens, cache, volumes)
  4. Configura Gemini no .env
  5. Rebuild backend
  6. Inicia serviรงos

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
๐ COMANDOS PARA EXECUTAR NO EC2
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

# 1. Ir para o diretรณrio
cd ~/poc_multiagent_lang

# 2. Fazer pull das รบltimas mudanรงas
git pull origin main

# 3. Dar permissรฃo de execuรงรฃo
chmod +x cleanup-and-switch-gemini.sh

# 4. Executar o script
./cleanup-and-switch-gemini.sh

# O script vai:
#   ๐ Parar containers
#   ๐๏ธ  Remover Ollama (host + volume)
#   ๐๏ธ  Limpar Docker (imagens, cache)
#   ๐พ Backup do .env
#   โ๏ธ  Configurar Gemini
#   ๐จ Rebuild backend
#   ๐ Iniciar serviรงos
#   ๐ Mostrar espaรงo liberado

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
๐พ ESPAรO QUE SERร LIBERADO
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

Ollama host: ~500MB
Ollama models: ~4GB
Ollama Docker volume: ~4GB
Imagens Docker antigas: 1-3GB
Cache de build: 500MB-1GB

TOTAL ESPERADO: 8-12GB liberados!

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โฑ๏ธ  TEMPO ESTIMADO
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

Limpeza: ~2-3 minutos
Rebuild: ~3-5 minutos
TOTAL: ~5-8 minutos

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ RESULTADO ESPERADO
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

Apรณs executar o script:

1. Espaรงo em disco:
   ANTES: ~90% usado
   DEPOIS: ~70-80% usado (8-12GB liberados)

2. Serviรงos rodando:
   โ postgres (porta 5433)
   โ backend (porta 8000)
   โ frontend (porta 8501)
   โ ollama (removido)

3. Configuraรงรฃo:
   โ LLM_TYPE=gemini
   โ GEMINI_API_KEY configurada
   โ GEMINI_MODEL=gemini-2.0-flash

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
๐ VERIFICAR APรS EXECUรรO
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

# Ver logs do backend
docker compose logs -f backend

# Deve mostrar:
# โ "Initialized GeminiLLM with model=models/gemini-2.0-flash"
# โ "Application startup complete"

# Pressione Ctrl+C para sair

# Testar API
curl -X POST http://localhost:8000/analyze \
  -H 'Content-Type: application/json' \
  -d '{"regulatory_text":"RESOLUรรO BCB Nยบ 789/2024","repo_path":"/app/fake_pix_repo"}'

# Deve retornar:
# โ Status 200 OK
# โ Resposta em ~10-15 segundos
# โ JSON completo com anรกlise

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
๐ฏ VANTAGENS DA NOVA CONFIGURAรรO
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

โ 8-12GB de espaรงo liberado
โ 20x mais rรกpido (2-5s vs 60s+ por request)
โ Sem problemas de RAM
โ Sem problemas de espaรงo em disco
โ Qualidade superior de resposta
โ Bug 404 do Gemini corrigido
โ Configuraรงรฃo mais simples
โ Menos recursos consumidos

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
๐ง SE DER ALGUM PROBLEMA
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

# Ver logs detalhados
docker compose logs backend | tail -100

# Verificar containers
docker compose ps

# Verificar .env
cat .env

# Verificar espaรงo em disco
df -h

# Reiniciar serviรงos
docker compose restart

# Ver erros especรญficos
docker compose logs backend | grep ERROR

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
๐ก DICAS
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

1. O script faz backup do .env antes de modificar
   Backup em: .env.backup.YYYYMMDD_HHMMSS

2. Se precisar voltar para Ollama (nรฃo recomendado):
   cp .env.backup.* .env
   docker compose up -d

3. Para manter o servidor limpo:
   Execute ./cleanup-server.sh semanalmente

4. Monitore o espaรงo em disco:
   df -h
   docker system df

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
๐ MONITORAMENTO PรS-MIGRAรรO
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

# Ver uso de recursos
docker stats --no-stream

# Ver espaรงo em disco
df -h

# Ver uso do Docker
docker system df

# Ver logs em tempo real
docker compose logs -f

# Testar performance
time curl -X POST http://localhost:8000/analyze \
  -H 'Content-Type: application/json' \
  -d '{"regulatory_text":"RESOLUรรO BCB Nยบ 789/2024","repo_path":"/app/fake_pix_repo"}'

# Deve completar em ~10-15 segundos
